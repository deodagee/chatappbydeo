(()=>{var e={};e.id=635,e.ids=[635],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},34605:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>h,pages:()=>x,routeModule:()=>m,tree:()=>c});var t=r(73137),a=r(54647),i=r(4183),l=r.n(i),d=r(71775),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);r.d(s,n);let o=t.AppPageRouteModule,c=["",{children:["(dashboard)",{children:["dashboard",{children:["chat",{children:["[chatId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,61971)),"C:\\Users\\User\\Demo Apps For My Official Website\\Good Website Models\\chatappbydeo\\src\\app\\(dashboard)\\dashboard\\chat\\[chatId]\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(r.bind(r,53761)),"C:\\Users\\User\\Demo Apps For My Official Website\\Good Website Models\\chatappbydeo\\src\\app\\(dashboard)\\dashboard\\chat\\[chatId]\\loading.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,84493)),"C:\\Users\\User\\Demo Apps For My Official Website\\Good Website Models\\chatappbydeo\\src\\app\\(dashboard)\\dashboard\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,59197)),"C:\\Users\\User\\Demo Apps For My Official Website\\Good Website Models\\chatappbydeo\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["C:\\Users\\User\\Demo Apps For My Official Website\\Good Website Models\\chatappbydeo\\src\\app\\(dashboard)\\dashboard\\chat\\[chatId]\\page.tsx"],h="/(dashboard)/dashboard/chat/[chatId]/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new o({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/dashboard/chat/[chatId]/page",pathname:"/dashboard/chat/[chatId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},78594:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,25251,23)),Promise.resolve().then(r.t.bind(r,42796,23)),Promise.resolve().then(r.bind(r,95688)),Promise.resolve().then(r.bind(r,32597))},96288:(e,s,r)=>{Promise.resolve().then(r.bind(r,43285))},95688:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var t=r(60080),a=r(93258),i=r(9885),l=r(10345),d=r(67887),n=r(88043);let __WEBPACK_DEFAULT_EXPORT__=({chatPartner:e,chatId:s})=>{let r=(0,i.useRef)(null),[o,c]=(0,i.useState)(!1),[x,h]=(0,i.useState)(""),sendMessage=async()=>{if(x){c(!0);try{await a.default.post("/api/message/send",{text:x,chatId:s}),h(""),r.current?.focus()}catch{l.Am.error("Something went wrong. Please try again later.")}finally{c(!1)}}};return t.jsx("div",{className:"border-t border-gray-200 px-4 pt-4 mb-2 sm:mb-0",children:(0,t.jsxs)("div",{className:"relative flex-1 overflow-hidden rounded-lg shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-indigo-600",children:[t.jsx(d.Z,{ref:r,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),sendMessage())},rows:1,value:x,onChange:e=>h(e.target.value),placeholder:`Message ${e.name}`,className:"block w-full resize-none border-0 bg-transparent text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:py-1.5 sm:text-sm sm:leading-6"}),t.jsx("div",{onClick:()=>r.current?.focus(),className:"py-2","aria-hidden":"true",children:t.jsx("div",{className:"py-px",children:t.jsx("div",{className:"h-9"})})}),t.jsx("div",{className:"absolute right-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:t.jsx("div",{className:"flex-shrin-0",children:t.jsx(n.Z,{isLoading:o,onClick:sendMessage,type:"submit",children:"Post"})})})]})})}},32597:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var t=r(60080),a=r(14600),i=r(1712),l=r(11866),d=r(52451),n=r.n(d),o=r(9885);let __WEBPACK_DEFAULT_EXPORT__=({initialMessages:e,sessionId:s,chatId:r,chatPartner:d,sessionImg:c})=>{let[x,h]=(0,o.useState)(e);(0,o.useEffect)(()=>{a.b.subscribe((0,i.h)(`chat:${r}`));let messageHandler=e=>{h(s=>[e,...s])};return a.b.bind("incoming-message",messageHandler),()=>{a.b.unsubscribe((0,i.h)(`chat:${r}`)),a.b.unbind("incoming-message",messageHandler)}},[r]);let u=(0,o.useRef)(null),formatTimestamp=e=>(0,l.Z)(e,"HH:mm");return(0,t.jsxs)("div",{id:"messages",className:"flex h-full flex-1 flex-col-reverse gap-4 p-3 overflow-y-auto scrollbar-thumb-blue scrollbar-thumb-rounded scrollbar-track-blue-lighter scrollbar-w-2 scrolling-touch",children:[t.jsx("div",{ref:u}),x.map((e,r)=>{let a=e.senderId===s,l=x[r-1]?.senderId===x[r].senderId;return t.jsx("div",{className:"chat-message",children:(0,t.jsxs)("div",{className:(0,i.cn)("flex items-end",{"justify-end":a}),children:[t.jsx("div",{className:(0,i.cn)("flex flex-col space-y-2 text-base max-w-xs mx-2",{"order-1 items-end":a,"order-2 items-start":!a}),children:(0,t.jsxs)("span",{className:(0,i.cn)("px-4 py-2 rounded-lg inline-block",{"bg-indigo-600 text-white":a,"bg-gray-200 text-gray-900":!a,"rounded-br-none":!l&&a,"rounded-bl-none":!l&&!a}),children:[e.text," ",t.jsx("span",{className:"ml-2 text-xs text-gray-400",children:formatTimestamp(e.timestamp)})]})}),t.jsx("div",{className:(0,i.cn)("relative w-6 h-6 p-5",{"order-2":a,"order-1":!a,invisible:l}),children:t.jsx(n(),{fill:!0,src:a?c:d.image,alt:"Profile picture",referrerPolicy:"no-referrer",className:"rounded-full"})})]})},`${e.id}-${e.timestamp}`)})]})}},53761:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var t=r(48144),a=r(21791);let __WEBPACK_DEFAULT_EXPORT__=({})=>(0,t.jsxs)("div",{className:"flex flex-col h-full items-center",children:[t.jsx(a.ZP,{className:"mb-4",height:40,width:400}),t.jsx("div",{className:"flex-1 max-h-full overflow-y-scroll w-full",children:t.jsx("div",{className:"flex flex-col flex-auto h-full p-6",children:t.jsx("div",{className:"flex flex-col flex-auto flex-shrink-0 rounded-2xl bg-gray-50 h-full p-4",children:t.jsx("div",{className:"flex flex-col h-full overflow-x-auto mb-4",children:t.jsx("div",{className:"flex flex-col h-full",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-y-2",children:[t.jsx("div",{className:"col-start-6 col-end-13 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-start flex-row-reverse",children:[t.jsx("div",{className:"relative h-10 w-10",children:t.jsx(a.ZP,{width:40,height:40,borderRadius:999})}),t.jsx("div",{className:"relative mr-3 text-sm bg-indigo-100 text-black py-2 px-4 border border-gray-100 rounded-xl",children:t.jsx(a.ZP,{className:"ml-2",width:150,height:20})})]})}),t.jsx("div",{className:"col-start-6 col-end-13 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-start flex-row-reverse",children:[t.jsx("div",{className:"relative h-10 w-10",children:t.jsx(a.ZP,{width:40,height:40,borderRadius:999})}),t.jsx("div",{className:"relative mr-3 text-sm bg-indigo-100 text-black py-2 px-4 border border-gray-100 rounded-xl",children:t.jsx(a.ZP,{className:"ml-2",width:150,height:20})})]})}),t.jsx("div",{className:"col-start-1 col-end-8 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex flex-row items-center",children:[t.jsx("div",{className:"relative h-10 w-10",children:t.jsx(a.ZP,{width:40,height:40,borderRadius:999})}),t.jsx("div",{className:"relative ml-3 text-sm bg-white py-2 px-4 border border-gray-100 rounded-xl",children:t.jsx(a.ZP,{className:"ml-2",width:150,height:20})})]})}),t.jsx("div",{className:"col-start-6 col-end-13 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-start flex-row-reverse",children:[t.jsx("div",{className:"relative h-10 w-10",children:t.jsx(a.ZP,{width:40,height:40,borderRadius:999})}),t.jsx("div",{className:"relative mr-3 text-sm bg-indigo-100 text-black py-2 px-4 border border-gray-100 rounded-xl",children:t.jsx(a.ZP,{className:"ml-2",width:150,height:20})})]})}),t.jsx("div",{className:"col-start-1 col-end-8 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex flex-row items-center",children:[t.jsx("div",{className:"relative h-10 w-10",children:t.jsx(a.ZP,{width:40,height:40,borderRadius:999})}),t.jsx("div",{className:"relative ml-3 text-sm bg-white py-2 px-4 border border-gray-100 rounded-xl",children:t.jsx(a.ZP,{className:"ml-2",width:150,height:20})})]})})]})})})})})})]})},61971:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>y,generateMetadata:()=>generateMetadata});var t=r(48144),a=r(17536);let i=(0,a.createProxy)(String.raw`C:\Users\User\Demo Apps For My Official Website\Good Website Models\chatappbydeo\src\components\ChatInput.tsx`),{__esModule:l,$$typeof:d}=i,n=i.default,o=(0,a.createProxy)(String.raw`C:\Users\User\Demo Apps For My Official Website\Good Website Models\chatappbydeo\src\components\Messages.tsx`),{__esModule:c,$$typeof:x}=o,h=o.default;var u=r(60187),m=r(73865),p=r(41366),g=r(3471),f=r(75042),b=r.n(f),v=r(6465);async function generateMetadata({params:e}){let s=await (0,g.getServerSession)(m.L);s||(0,v.notFound)();let[r,t]=e.chatId.split("--"),{user:a}=s,i=a.id===r?t:r,l=await (0,u.Y)("get",`user:${i}`),d=JSON.parse(l);return{title:`FriendZone | ${d.name} chat`}}async function getChatMessages(e){try{let s=await (0,u.Y)("zrange",`chat:${e}:messages`,0,-1),r=s.map(e=>JSON.parse(e)),t=r.reverse(),a=p.T.parse(t);return a}catch(e){(0,v.notFound)()}}let page=async({params:e})=>{let{chatId:s}=e,r=await (0,g.getServerSession)(m.L);r||(0,v.notFound)();let{user:a}=r,[i,l]=s.split("--");a.id!==i&&a.id!==l&&(0,v.notFound)();let d=a.id===i?l:i,o=await (0,u.Y)("get",`user:${d}`),c=JSON.parse(o),x=await getChatMessages(s);return(0,t.jsxs)("div",{className:"flex-1 justify-between flex flex-col h-full max-h-[calc(100vh-6rem)]",children:[t.jsx("div",{className:"flex sm:items-center justify-between py-3 border-b-2 border-gray-200",children:(0,t.jsxs)("div",{className:"relative flex items-center space-x-4",children:[t.jsx("div",{className:"relative",children:t.jsx("div",{className:"relative w-8 sm:w-12 h-8 sm:h-12",children:t.jsx(b(),{fill:!0,referrerPolicy:"no-referrer",src:c.image,alt:`${c.name} profile picture`,className:"rounded-full"})})}),(0,t.jsxs)("div",{className:"flex flex-col leading-tight",children:[t.jsx("div",{className:"text-xl flex items-center",children:t.jsx("span",{className:"text-gray-700 mr-3 font-semibold",children:c.name})}),t.jsx("span",{className:"text-sm text-gray-600",children:c.email})]})]})}),t.jsx(h,{chatId:s,chatPartner:c,sessionImg:r.user.image,sessionId:r.user.id,initialMessages:x}),t.jsx(n,{chatId:s,chatPartner:c})]})},y=page},41366:(e,s,r)=>{"use strict";r.d(s,{O:()=>a,T:()=>i});var t=r(45952);let a=t.z.object({id:t.z.string(),senderId:t.z.string(),text:t.z.string(),timestamp:t.z.number()}),i=t.z.array(a)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[650,401,333,35,885,258,952,8,45,693,865,571,917,672],()=>__webpack_exec__(34605));module.exports=r})();