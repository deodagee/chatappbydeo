"use strict";exports.id=401,exports.ids=[401],exports.modules={54401:(e,t,n)=>{n.d(t,{s:()=>Redis});let UpstashError=class UpstashError extends Error{constructor(e){super(e),this.name="UpstashError"}};function parseResponse(e){try{return function parseRecursive(e){let t=Array.isArray(e)?e.map(e=>{try{return parseRecursive(e)}catch{return e}}):JSON.parse(e);return"number"==typeof t&&t.toString()!=e?e:t}(e)}catch{return e}}let defaultSerializer=e=>{switch(typeof e){case"string":case"number":case"boolean":return e;default:return JSON.stringify(e)}};let Command=class Command{constructor(e,t){Object.defineProperty(this,"command",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deserialize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.serialize=defaultSerializer,this.deserialize=void 0===t?.automaticDeserialization||t.automaticDeserialization?t?.deserialize??parseResponse:e=>e,this.command=e.map(e=>this.serialize(e))}async exec(e){let{result:t,error:n}=await e.request({body:this.command});if(n)throw new UpstashError(n);if(void 0===t)throw Error("Request did not return a result");return this.deserialize(t)}};let AppendCommand=class AppendCommand extends Command{constructor(e,t){super(["append",...e],t)}};let BitCountCommand=class BitCountCommand extends Command{constructor([e,t,n],i){let r=["bitcount",e];"number"==typeof t&&r.push(t),"number"==typeof n&&r.push(n),super(r,i)}};let BitOpCommand=class BitOpCommand extends Command{constructor(e,t){super(["bitop",...e],t)}};let BitPosCommand=class BitPosCommand extends Command{constructor(e,t){super(["bitpos",...e],t)}};let DBSizeCommand=class DBSizeCommand extends Command{constructor(e){super(["dbsize"],e)}};let DecrCommand=class DecrCommand extends Command{constructor(e,t){super(["decr",...e],t)}};let DecrByCommand=class DecrByCommand extends Command{constructor(e,t){super(["decrby",...e],t)}};let DelCommand=class DelCommand extends Command{constructor(e,t){super(["del",...e],t)}};let EchoCommand=class EchoCommand extends Command{constructor(e,t){super(["echo",...e],t)}};let EvalCommand=class EvalCommand extends Command{constructor([e,t,n],i){super(["eval",e,t.length,...t,...n??[]],i)}};let EvalshaCommand=class EvalshaCommand extends Command{constructor([e,t,n],i){super(["evalsha",e,t.length,...t,...n??[]],i)}};let ExistsCommand=class ExistsCommand extends Command{constructor(e,t){super(["exists",...e],t)}};let ExpireCommand=class ExpireCommand extends Command{constructor(e,t){super(["expire",...e],t)}};let ExpireAtCommand=class ExpireAtCommand extends Command{constructor(e,t){super(["expireat",...e],t)}};let FlushAllCommand=class FlushAllCommand extends Command{constructor(e,t){let n=["flushall"];e&&e.length>0&&e[0].async&&n.push("async"),super(n,t)}};let FlushDBCommand=class FlushDBCommand extends Command{constructor([e],t){let n=["flushdb"];e?.async&&n.push("async"),super(n,t)}};let GetCommand=class GetCommand extends Command{constructor(e,t){super(["get",...e],t)}};let GetBitCommand=class GetBitCommand extends Command{constructor(e,t){super(["getbit",...e],t)}};let GetDelCommand=class GetDelCommand extends Command{constructor(e,t){super(["getdel",...e],t)}};let GetRangeCommand=class GetRangeCommand extends Command{constructor(e,t){super(["getrange",...e],t)}};let GetSetCommand=class GetSetCommand extends Command{constructor(e,t){super(["getset",...e],t)}};let HDelCommand=class HDelCommand extends Command{constructor(e,t){super(["hdel",...e],t)}};let HExistsCommand=class HExistsCommand extends Command{constructor(e,t){super(["hexists",...e],t)}};let HGetCommand=class HGetCommand extends Command{constructor(e,t){super(["hget",...e],t)}};let HGetAllCommand=class HGetAllCommand extends Command{constructor(e,t){super(["hgetall",...e],{deserialize:e=>(function(e){if(0===e.length)return null;let t={};for(;e.length>=2;){let n=e.shift(),i=e.shift();try{t[n]=JSON.parse(i)}catch{t[n]=i}}return t})(e),...t})}};let HIncrByCommand=class HIncrByCommand extends Command{constructor(e,t){super(["hincrby",...e],t)}};let HIncrByFloatCommand=class HIncrByFloatCommand extends Command{constructor(e,t){super(["hincrbyfloat",...e],t)}};let HKeysCommand=class HKeysCommand extends Command{constructor([e],t){super(["hkeys",e],t)}};let HLenCommand=class HLenCommand extends Command{constructor(e,t){super(["hlen",...e],t)}};let HMGetCommand=class HMGetCommand extends Command{constructor([e,...t],n){super(["hmget",e,...t],{deserialize:e=>(function(e,t){if(0===t.length||t.every(e=>null===e))return null;let n={};for(let i=0;i<e.length;i++)try{n[e[i]]=JSON.parse(t[i])}catch{n[e[i]]=t[i]}return n})(t,e),...n})}};let HMSetCommand=class HMSetCommand extends Command{constructor([e,t],n){super(["hmset",e,...Object.entries(t).flatMap(([e,t])=>[e,t])],n)}};let HRandFieldCommand=class HRandFieldCommand extends Command{constructor(e,t){let n=["hrandfield",e[0]];"number"==typeof e[1]&&n.push(e[1]),e[2]&&n.push("WITHVALUES"),super(n,{deserialize:e[2]?e=>(function(e){if(0===e.length)return null;let t={};for(;e.length>=2;){let n=e.shift(),i=e.shift();try{t[n]=JSON.parse(i)}catch{t[n]=i}}return t})(e):t?.deserialize,...t})}};let HScanCommand=class HScanCommand extends Command{constructor([e,t,n],i){let r=["hscan",e,t];n?.match&&r.push("match",n.match),"number"==typeof n?.count&&r.push("count",n.count),super(r,i)}};let HSetCommand=class HSetCommand extends Command{constructor([e,t],n){super(["hset",e,...Object.entries(t).flatMap(([e,t])=>[e,t])],n)}};let HSetNXCommand=class HSetNXCommand extends Command{constructor(e,t){super(["hsetnx",...e],t)}};let HStrLenCommand=class HStrLenCommand extends Command{constructor(e,t){super(["hstrlen",...e],t)}};let HValsCommand=class HValsCommand extends Command{constructor(e,t){super(["hvals",...e],t)}};let IncrCommand=class IncrCommand extends Command{constructor(e,t){super(["incr",...e],t)}};let IncrByCommand=class IncrByCommand extends Command{constructor(e,t){super(["incrby",...e],t)}};let IncrByFloatCommand=class IncrByFloatCommand extends Command{constructor(e,t){super(["incrbyfloat",...e],t)}};let KeysCommand=class KeysCommand extends Command{constructor(e,t){super(["keys",...e],t)}};let LIndexCommand=class LIndexCommand extends Command{constructor(e,t){super(["lindex",...e],t)}};let LInsertCommand=class LInsertCommand extends Command{constructor(e,t){super(["linsert",...e],t)}};let LLenCommand=class LLenCommand extends Command{constructor(e,t){super(["llen",...e],t)}};let LMoveCommand=class LMoveCommand extends Command{constructor(e,t){super(["lmove",...e],t)}};let LPopCommand=class LPopCommand extends Command{constructor(e,t){super(["lpop",...e],t)}};let LPosCommand=class LPosCommand extends Command{constructor(e,t){let n=["lpos",e[0],e[1]];"number"==typeof e[2]?.rank&&n.push("rank",e[2].rank),"number"==typeof e[2]?.count&&n.push("count",e[2].count),"number"==typeof e[2]?.maxLen&&n.push("maxLen",e[2].maxLen),super(n,t)}};let LPushCommand=class LPushCommand extends Command{constructor(e,t){super(["lpush",...e],t)}};let LPushXCommand=class LPushXCommand extends Command{constructor(e,t){super(["lpushx",...e],t)}};let LRangeCommand=class LRangeCommand extends Command{constructor(e,t){super(["lrange",...e],t)}};let LRemCommand=class LRemCommand extends Command{constructor(e,t){super(["lrem",...e],t)}};let LSetCommand=class LSetCommand extends Command{constructor(e,t){super(["lset",...e],t)}};let LTrimCommand=class LTrimCommand extends Command{constructor(e,t){super(["ltrim",...e],t)}};let MGetCommand=class MGetCommand extends Command{constructor(e,t){super(["mget",...e],t)}};let MSetCommand=class MSetCommand extends Command{constructor([e],t){super(["mset",...Object.entries(e).flatMap(([e,t])=>[e,t])],t)}};let MSetNXCommand=class MSetNXCommand extends Command{constructor([e],t){super(["msetnx",...Object.entries(e).flatMap(e=>e)],t)}};let PersistCommand=class PersistCommand extends Command{constructor(e,t){super(["persist",...e],t)}};let PExpireCommand=class PExpireCommand extends Command{constructor(e,t){super(["pexpire",...e],t)}};let PExpireAtCommand=class PExpireAtCommand extends Command{constructor(e,t){super(["pexpireat",...e],t)}};let PingCommand=class PingCommand extends Command{constructor(e,t){let n=["ping"];void 0!==e&&void 0!==e[0]&&n.push(e[0]),super(n,t)}};let PSetEXCommand=class PSetEXCommand extends Command{constructor(e,t){super(["psetex",...e],t)}};let PTtlCommand=class PTtlCommand extends Command{constructor(e,t){super(["pttl",...e],t)}};let PublishCommand=class PublishCommand extends Command{constructor(e,t){super(["publish",...e],t)}};let RandomKeyCommand=class RandomKeyCommand extends Command{constructor(e){super(["randomkey"],e)}};let RenameCommand=class RenameCommand extends Command{constructor(e,t){super(["rename",...e],t)}};let RenameNXCommand=class RenameNXCommand extends Command{constructor(e,t){super(["renamenx",...e],t)}};let RPopCommand=class RPopCommand extends Command{constructor(e,t){super(["rpop",...e],t)}};let RPushCommand=class RPushCommand extends Command{constructor(e,t){super(["rpush",...e],t)}};let RPushXCommand=class RPushXCommand extends Command{constructor(e,t){super(["rpushx",...e],t)}};let SAddCommand=class SAddCommand extends Command{constructor(e,t){super(["sadd",...e],t)}};let ScanCommand=class ScanCommand extends Command{constructor([e,t],n){let i=["scan",e];t?.match&&i.push("match",t.match),"number"==typeof t?.count&&i.push("count",t.count),t?.type&&t.type.length>0&&i.push("type",t.type),super(i,n)}};let SCardCommand=class SCardCommand extends Command{constructor(e,t){super(["scard",...e],t)}};let ScriptExistsCommand=class ScriptExistsCommand extends Command{constructor(e,t){super(["script","exists",...e],{deserialize:e=>e,...t})}};let ScriptFlushCommand=class ScriptFlushCommand extends Command{constructor([e],t){let n=["script","flush"];e?.sync?n.push("sync"):e?.async&&n.push("async"),super(n,t)}};let ScriptLoadCommand=class ScriptLoadCommand extends Command{constructor(e,t){super(["script","load",...e],t)}};let SDiffCommand=class SDiffCommand extends Command{constructor(e,t){super(["sdiff",...e],t)}};let SDiffStoreCommand=class SDiffStoreCommand extends Command{constructor(e,t){super(["sdiffstore",...e],t)}};let SetCommand=class SetCommand extends Command{constructor([e,t,n],i){let r=["set",e,t];n&&("nx"in n&&n.nx?r.push("nx"):"xx"in n&&n.xx&&r.push("xx"),"get"in n&&n.get&&r.push("get"),"ex"in n&&"number"==typeof n.ex?r.push("ex",n.ex):"px"in n&&"number"==typeof n.px?r.push("px",n.px):"exat"in n&&"number"==typeof n.exat?r.push("exat",n.exat):"pxat"in n&&"number"==typeof n.pxat?r.push("pxat",n.pxat):"keepTtl"in n&&n.keepTtl&&r.push("keepTtl")),super(r,i)}};let SetBitCommand=class SetBitCommand extends Command{constructor(e,t){super(["setbit",...e],t)}};let SetExCommand=class SetExCommand extends Command{constructor(e,t){super(["setex",...e],t)}};let SetNxCommand=class SetNxCommand extends Command{constructor(e,t){super(["setnx",...e],t)}};let SetRangeCommand=class SetRangeCommand extends Command{constructor(e,t){super(["setrange",...e],t)}};let SInterCommand=class SInterCommand extends Command{constructor(e,t){super(["sinter",...e],t)}};let SInterStoreCommand=class SInterStoreCommand extends Command{constructor(e,t){super(["sinterstore",...e],t)}};let SIsMemberCommand=class SIsMemberCommand extends Command{constructor(e,t){super(["sismember",...e],t)}};let SMIsMemberCommand=class SMIsMemberCommand extends Command{constructor(e,t){super(["smismember",e[0],...e[1]],t)}};let SMembersCommand=class SMembersCommand extends Command{constructor(e,t){super(["smembers",...e],t)}};let SMoveCommand=class SMoveCommand extends Command{constructor(e,t){super(["smove",...e],t)}};let SPopCommand=class SPopCommand extends Command{constructor([e,t],n){let i=["spop",e];"number"==typeof t&&i.push(t),super(i,n)}};let SRandMemberCommand=class SRandMemberCommand extends Command{constructor([e,t],n){let i=["srandmember",e];"number"==typeof t&&i.push(t),super(i,n)}};let SRemCommand=class SRemCommand extends Command{constructor(e,t){super(["srem",...e],t)}};let SScanCommand=class SScanCommand extends Command{constructor([e,t,n],i){let r=["sscan",e,t];n?.match&&r.push("match",n.match),"number"==typeof n?.count&&r.push("count",n.count),super(r,i)}};let StrLenCommand=class StrLenCommand extends Command{constructor(e,t){super(["strlen",...e],t)}};let SUnionCommand=class SUnionCommand extends Command{constructor(e,t){super(["sunion",...e],t)}};let SUnionStoreCommand=class SUnionStoreCommand extends Command{constructor(e,t){super(["sunionstore",...e],t)}};let TimeCommand=class TimeCommand extends Command{constructor(e){super(["time"],e)}};let TouchCommand=class TouchCommand extends Command{constructor(e,t){super(["touch",...e],t)}};let TtlCommand=class TtlCommand extends Command{constructor(e,t){super(["ttl",...e],t)}};let TypeCommand=class TypeCommand extends Command{constructor(e,t){super(["type",...e],t)}};let UnlinkCommand=class UnlinkCommand extends Command{constructor(e,t){super(["unlink",...e],t)}};let ZAddCommand=class ZAddCommand extends Command{constructor([e,t,...n],i){let r=["zadd",e];"nx"in t&&t.nx?r.push("nx"):"xx"in t&&t.xx&&r.push("xx"),"ch"in t&&t.ch&&r.push("ch"),"incr"in t&&t.incr&&r.push("incr"),"score"in t&&"member"in t&&r.push(t.score,t.member),r.push(...n.flatMap(({score:e,member:t})=>[e,t])),super(r,i)}};let ZCardCommand=class ZCardCommand extends Command{constructor(e,t){super(["zcard",...e],t)}};let ZCountCommand=class ZCountCommand extends Command{constructor(e,t){super(["zcount",...e],t)}};let ZIncrByCommand=class ZIncrByCommand extends Command{constructor(e,t){super(["zincrby",...e],t)}};let ZInterStoreCommand=class ZInterStoreCommand extends Command{constructor([e,t,n,i],r){let s=["zinterstore",e,t];Array.isArray(n)?s.push(...n):s.push(n),i&&("weights"in i&&i.weights?s.push("weights",...i.weights):"weight"in i&&"number"==typeof i.weight&&s.push("weights",i.weight),"aggregate"in i&&s.push("aggregate",i.aggregate)),super(s,r)}};let ZLexCountCommand=class ZLexCountCommand extends Command{constructor(e,t){super(["zlexcount",...e],t)}};let ZPopMaxCommand=class ZPopMaxCommand extends Command{constructor([e,t],n){let i=["zpopmax",e];"number"==typeof t&&i.push(t),super(i,n)}};let ZPopMinCommand=class ZPopMinCommand extends Command{constructor([e,t],n){let i=["zpopmin",e];"number"==typeof t&&i.push(t),super(i,n)}};let ZRangeCommand=class ZRangeCommand extends Command{constructor([e,t,n,i],r){let s=["zrange",e,t,n];i?.byScore&&s.push("byscore"),i?.byLex&&s.push("bylex"),i?.rev&&s.push("rev"),void 0!==i?.count&&void 0!==i?.offset&&s.push("limit",i.offset,i.count),i?.withScores&&s.push("withscores"),super(s,r)}};let ZRankCommand=class ZRankCommand extends Command{constructor(e,t){super(["zrank",...e],t)}};let ZRemCommand=class ZRemCommand extends Command{constructor(e,t){super(["zrem",...e],t)}};let ZRemRangeByLexCommand=class ZRemRangeByLexCommand extends Command{constructor(e,t){super(["zremrangebylex",...e],t)}};let ZRemRangeByRankCommand=class ZRemRangeByRankCommand extends Command{constructor(e,t){super(["zremrangebyrank",...e],t)}};let ZRemRangeByScoreCommand=class ZRemRangeByScoreCommand extends Command{constructor(e,t){super(["zremrangebyscore",...e],t)}};let ZRevRankCommand=class ZRevRankCommand extends Command{constructor(e,t){super(["zrevrank",...e],t)}};let ZScanCommand=class ZScanCommand extends Command{constructor([e,t,n],i){let r=["zscan",e,t];n?.match&&r.push("match",n.match),"number"==typeof n?.count&&r.push("count",n.count),super(r,i)}};let ZScoreCommand=class ZScoreCommand extends Command{constructor(e,t){super(["zscore",...e],t)}};let ZUnionStoreCommand=class ZUnionStoreCommand extends Command{constructor([e,t,n,i],r){let s=["zunionstore",e,t];Array.isArray(n)?s.push(...n):s.push(n),i&&("weights"in i&&i.weights?s.push("weights",...i.weights):"weight"in i&&"number"==typeof i.weight&&s.push("weights",i.weight),"aggregate"in i&&s.push("aggregate",i.aggregate)),super(s,r)}};let JsonArrAppendCommand=class JsonArrAppendCommand extends Command{constructor(e,t){super(["JSON.ARRAPPEND",...e],t)}};let JsonArrIndexCommand=class JsonArrIndexCommand extends Command{constructor(e,t){super(["JSON.ARRINDEX",...e],t)}};let JsonArrInsertCommand=class JsonArrInsertCommand extends Command{constructor(e,t){super(["JSON.ARRINSERT",...e],t)}};let JsonArrLenCommand=class JsonArrLenCommand extends Command{constructor(e,t){super(["JSON.ARRLEN",e[0],e[1]??"$"],t)}};let JsonArrPopCommand=class JsonArrPopCommand extends Command{constructor(e,t){super(["JSON.ARRPOP",...e],t)}};let JsonArrTrimCommand=class JsonArrTrimCommand extends Command{constructor(e,t){let n=e[1]??"$",i=e[2]??0,r=e[3]??0;super(["JSON.ARRTRIM",e[0],n,i,r],t)}};let JsonClearCommand=class JsonClearCommand extends Command{constructor(e,t){super(["JSON.CLEAR",...e],t)}};let JsonDelCommand=class JsonDelCommand extends Command{constructor(e,t){super(["JSON.DEL",...e],t)}};let JsonForgetCommand=class JsonForgetCommand extends Command{constructor(e,t){super(["JSON.FORGET",...e],t)}};let JsonGetCommand=class JsonGetCommand extends Command{constructor(e,t){let n=["JSON.GET"];"string"==typeof e[1]?n.push(...e):(n.push(e[0]),e[1]&&(e[1].indent&&n.push("INDENT",e[1].indent),e[1].newline&&n.push("NEWLINE",e[1].newline),e[1].space&&n.push("SPACE",e[1].space)),n.push(...e.slice(2))),super(n,t)}};let JsonMGetCommand=class JsonMGetCommand extends Command{constructor(e,t){super(["JSON.MGET",...e[0],e[1]],t)}};let JsonNumIncrByCommand=class JsonNumIncrByCommand extends Command{constructor(e,t){super(["JSON.NUMINCRBY",...e],t)}};let JsonNumMultByCommand=class JsonNumMultByCommand extends Command{constructor(e,t){super(["JSON.NUMMULTBY",...e],t)}};let JsonObjKeysCommand=class JsonObjKeysCommand extends Command{constructor(e,t){super(["JSON.OBJKEYS",...e],t)}};let JsonObjLenCommand=class JsonObjLenCommand extends Command{constructor(e,t){super(["JSON.OBJLEN",...e],t)}};let JsonRespCommand=class JsonRespCommand extends Command{constructor(e,t){super(["JSON.RESP",...e],t)}};let JsonSetCommand=class JsonSetCommand extends Command{constructor(e,t){let n=["JSON.SET",e[0],e[1],e[2]];e[3]&&(e[3].nx?n.push("NX"):e[3].xx&&n.push("XX")),super(n,t)}};let JsonStrAppendCommand=class JsonStrAppendCommand extends Command{constructor(e,t){super(["JSON.STRAPPEND",...e],t)}};let JsonStrLenCommand=class JsonStrLenCommand extends Command{constructor(e,t){super(["JSON.STRLEN",...e],t)}};let JsonToggleCommand=class JsonToggleCommand extends Command{constructor(e,t){super(["JSON.TOGGLE",...e],t)}};let JsonTypeCommand=class JsonTypeCommand extends Command{constructor(e,t){super(["JSON.TYPE",...e],t)}};let ZMScoreCommand=class ZMScoreCommand extends Command{constructor(e,t){let[n,i]=e;super(["zmscore",n,...i],t)}};let ZDiffStoreCommand=class ZDiffStoreCommand extends Command{constructor(e,t){super(["zdiffstore",...e],t)}};let Pipeline=class Pipeline{constructor(e){Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"commands",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"commandOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multiExec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exec",{enumerable:!0,configurable:!0,writable:!0,value:async()=>{if(0===this.commands.length)throw Error("Pipeline is empty");let e=this.multiExec?["multi-exec"]:["pipeline"],t=await this.client.request({path:e,body:Object.values(this.commands).map(e=>e.command)});return t.map(({error:e,result:t},n)=>{if(e)throw new UpstashError(`Command ${n+1} [ ${this.commands[n].command[0]} ] failed: ${e}`);return this.commands[n].deserialize(t)})}}),Object.defineProperty(this,"append",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new AppendCommand(e,this.commandOptions))}),Object.defineProperty(this,"bitcount",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new BitCountCommand(e,this.commandOptions))}),Object.defineProperty(this,"bitop",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n,...i)=>this.chain(new BitOpCommand([e,t,n,...i],this.commandOptions))}),Object.defineProperty(this,"bitpos",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new BitPosCommand(e,this.commandOptions))}),Object.defineProperty(this,"zdiffstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZDiffStoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"dbsize",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.chain(new DBSizeCommand(this.commandOptions))}),Object.defineProperty(this,"decr",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new DecrCommand(e,this.commandOptions))}),Object.defineProperty(this,"decrby",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new DecrByCommand(e,this.commandOptions))}),Object.defineProperty(this,"del",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new DelCommand(e,this.commandOptions))}),Object.defineProperty(this,"echo",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new EchoCommand(e,this.commandOptions))}),Object.defineProperty(this,"eval",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new EvalCommand(e,this.commandOptions))}),Object.defineProperty(this,"evalsha",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new EvalshaCommand(e,this.commandOptions))}),Object.defineProperty(this,"exists",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ExistsCommand(e,this.commandOptions))}),Object.defineProperty(this,"expire",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ExpireCommand(e,this.commandOptions))}),Object.defineProperty(this,"expireat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ExpireAtCommand(e,this.commandOptions))}),Object.defineProperty(this,"flushall",{enumerable:!0,configurable:!0,writable:!0,value:e=>this.chain(new FlushAllCommand(e,this.commandOptions))}),Object.defineProperty(this,"flushdb",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new FlushDBCommand(e,this.commandOptions))}),Object.defineProperty(this,"get",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new GetCommand(e,this.commandOptions))}),Object.defineProperty(this,"getbit",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new GetBitCommand(e,this.commandOptions))}),Object.defineProperty(this,"getdel",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new GetDelCommand(e,this.commandOptions))}),Object.defineProperty(this,"getrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new GetRangeCommand(e,this.commandOptions))}),Object.defineProperty(this,"getset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new GetSetCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"hdel",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HDelCommand(e,this.commandOptions))}),Object.defineProperty(this,"hexists",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HExistsCommand(e,this.commandOptions))}),Object.defineProperty(this,"hget",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HGetCommand(e,this.commandOptions))}),Object.defineProperty(this,"hgetall",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HGetAllCommand(e,this.commandOptions))}),Object.defineProperty(this,"hincrby",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HIncrByCommand(e,this.commandOptions))}),Object.defineProperty(this,"hincrbyfloat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HIncrByFloatCommand(e,this.commandOptions))}),Object.defineProperty(this,"hkeys",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HKeysCommand(e,this.commandOptions))}),Object.defineProperty(this,"hlen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HLenCommand(e,this.commandOptions))}),Object.defineProperty(this,"hmget",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HMGetCommand(e,this.commandOptions))}),Object.defineProperty(this,"hmset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new HMSetCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"hrandfield",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new HRandFieldCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"hscan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HScanCommand(e,this.commandOptions))}),Object.defineProperty(this,"hset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new HSetCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"hsetnx",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new HSetNXCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"hstrlen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HStrLenCommand(e,this.commandOptions))}),Object.defineProperty(this,"hvals",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new HValsCommand(e,this.commandOptions))}),Object.defineProperty(this,"incr",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new IncrCommand(e,this.commandOptions))}),Object.defineProperty(this,"incrby",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new IncrByCommand(e,this.commandOptions))}),Object.defineProperty(this,"incrbyfloat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new IncrByFloatCommand(e,this.commandOptions))}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new KeysCommand(e,this.commandOptions))}),Object.defineProperty(this,"lindex",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LIndexCommand(e,this.commandOptions))}),Object.defineProperty(this,"linsert",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n,i)=>this.chain(new LInsertCommand([e,t,n,i],this.commandOptions))}),Object.defineProperty(this,"llen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LLenCommand(e,this.commandOptions))}),Object.defineProperty(this,"lmove",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LMoveCommand(e,this.commandOptions))}),Object.defineProperty(this,"lpop",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LPopCommand(e,this.commandOptions))}),Object.defineProperty(this,"lpos",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LPosCommand(e,this.commandOptions))}),Object.defineProperty(this,"lpush",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new LPushCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"lpushx",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new LPushXCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"lrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LRangeCommand(e,this.commandOptions))}),Object.defineProperty(this,"lrem",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new LRemCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"lset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new LSetCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"ltrim",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new LTrimCommand(e,this.commandOptions))}),Object.defineProperty(this,"mget",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new MGetCommand(e,this.commandOptions))}),Object.defineProperty(this,"mset",{enumerable:!0,configurable:!0,writable:!0,value:e=>this.chain(new MSetCommand([e],this.commandOptions))}),Object.defineProperty(this,"msetnx",{enumerable:!0,configurable:!0,writable:!0,value:e=>this.chain(new MSetNXCommand([e],this.commandOptions))}),Object.defineProperty(this,"persist",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new PersistCommand(e,this.commandOptions))}),Object.defineProperty(this,"pexpire",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new PExpireCommand(e,this.commandOptions))}),Object.defineProperty(this,"pexpireat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new PExpireAtCommand(e,this.commandOptions))}),Object.defineProperty(this,"ping",{enumerable:!0,configurable:!0,writable:!0,value:e=>this.chain(new PingCommand(e,this.commandOptions))}),Object.defineProperty(this,"psetex",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new PSetEXCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"pttl",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new PTtlCommand(e,this.commandOptions))}),Object.defineProperty(this,"publish",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new PublishCommand(e,this.commandOptions))}),Object.defineProperty(this,"randomkey",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.chain(new RandomKeyCommand(this.commandOptions))}),Object.defineProperty(this,"rename",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new RenameCommand(e,this.commandOptions))}),Object.defineProperty(this,"renamenx",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new RenameNXCommand(e,this.commandOptions))}),Object.defineProperty(this,"rpop",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new RPopCommand(e,this.commandOptions))}),Object.defineProperty(this,"rpush",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new RPushCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"rpushx",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new RPushXCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"sadd",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new SAddCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"scan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ScanCommand(e,this.commandOptions))}),Object.defineProperty(this,"scard",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SCardCommand(e,this.commandOptions))}),Object.defineProperty(this,"scriptExists",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ScriptExistsCommand(e,this.commandOptions))}),Object.defineProperty(this,"scriptFlush",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ScriptFlushCommand(e,this.commandOptions))}),Object.defineProperty(this,"scriptLoad",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ScriptLoadCommand(e,this.commandOptions))}),Object.defineProperty(this,"sdiff",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SDiffCommand(e,this.commandOptions))}),Object.defineProperty(this,"sdiffstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SDiffStoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"set",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new SetCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"setbit",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SetBitCommand(e,this.commandOptions))}),Object.defineProperty(this,"setex",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new SetExCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"setnx",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new SetNxCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"setrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SetRangeCommand(e,this.commandOptions))}),Object.defineProperty(this,"sinter",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SInterCommand(e,this.commandOptions))}),Object.defineProperty(this,"sinterstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SInterStoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"sismember",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new SIsMemberCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"smembers",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SMembersCommand(e,this.commandOptions))}),Object.defineProperty(this,"smismember",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new SMIsMemberCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"smove",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new SMoveCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"spop",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SPopCommand(e,this.commandOptions))}),Object.defineProperty(this,"srandmember",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SRandMemberCommand(e,this.commandOptions))}),Object.defineProperty(this,"srem",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new SRemCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"sscan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SScanCommand(e,this.commandOptions))}),Object.defineProperty(this,"strlen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new StrLenCommand(e,this.commandOptions))}),Object.defineProperty(this,"sunion",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SUnionCommand(e,this.commandOptions))}),Object.defineProperty(this,"sunionstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new SUnionStoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.chain(new TimeCommand(this.commandOptions))}),Object.defineProperty(this,"touch",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new TouchCommand(e,this.commandOptions))}),Object.defineProperty(this,"ttl",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new TtlCommand(e,this.commandOptions))}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new TypeCommand(e,this.commandOptions))}),Object.defineProperty(this,"unlink",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new UnlinkCommand(e,this.commandOptions))}),Object.defineProperty(this,"zadd",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>(e[1],this.chain(new ZAddCommand([e[0],e[1],...e.slice(2)],this.commandOptions)))}),Object.defineProperty(this,"zcard",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZCardCommand(e,this.commandOptions))}),Object.defineProperty(this,"zcount",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZCountCommand(e,this.commandOptions))}),Object.defineProperty(this,"zincrby",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>this.chain(new ZIncrByCommand([e,t,n],this.commandOptions))}),Object.defineProperty(this,"zinterstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZInterStoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"zlexcount",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZLexCountCommand(e,this.commandOptions))}),Object.defineProperty(this,"zmscore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZMScoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"zpopmax",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZPopMaxCommand(e,this.commandOptions))}),Object.defineProperty(this,"zpopmin",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZPopMinCommand(e,this.commandOptions))}),Object.defineProperty(this,"zrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZRangeCommand(e,this.commandOptions))}),Object.defineProperty(this,"zrank",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new ZRankCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"zrem",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>this.chain(new ZRemCommand([e,...t],this.commandOptions))}),Object.defineProperty(this,"zremrangebylex",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZRemRangeByLexCommand(e,this.commandOptions))}),Object.defineProperty(this,"zremrangebyrank",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZRemRangeByRankCommand(e,this.commandOptions))}),Object.defineProperty(this,"zremrangebyscore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZRemRangeByScoreCommand(e,this.commandOptions))}),Object.defineProperty(this,"zrevrank",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new ZRevRankCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"zscan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZScanCommand(e,this.commandOptions))}),Object.defineProperty(this,"zscore",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.chain(new ZScoreCommand([e,t],this.commandOptions))}),Object.defineProperty(this,"zunionstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>this.chain(new ZUnionStoreCommand(e,this.commandOptions))}),this.client=e.client,this.commands=[],this.commandOptions=e.commandOptions,this.multiExec=e.multiExec??!1}chain(e){return this.commands.push(e),this}get json(){return{arrappend:(...e)=>this.chain(new JsonArrAppendCommand(e,this.commandOptions)),arrindex:(...e)=>this.chain(new JsonArrIndexCommand(e,this.commandOptions)),arrinsert:(...e)=>this.chain(new JsonArrInsertCommand(e,this.commandOptions)),arrlen:(...e)=>this.chain(new JsonArrLenCommand(e,this.commandOptions)),arrpop:(...e)=>this.chain(new JsonArrPopCommand(e,this.commandOptions)),arrtrim:(...e)=>this.chain(new JsonArrTrimCommand(e,this.commandOptions)),clear:(...e)=>this.chain(new JsonClearCommand(e,this.commandOptions)),del:(...e)=>this.chain(new JsonDelCommand(e,this.commandOptions)),forget:(...e)=>this.chain(new JsonForgetCommand(e,this.commandOptions)),get:(...e)=>this.chain(new JsonGetCommand(e,this.commandOptions)),mget:(...e)=>this.chain(new JsonMGetCommand(e,this.commandOptions)),numincrby:(...e)=>this.chain(new JsonNumIncrByCommand(e,this.commandOptions)),nummultby:(...e)=>this.chain(new JsonNumMultByCommand(e,this.commandOptions)),objkeys:(...e)=>this.chain(new JsonObjKeysCommand(e,this.commandOptions)),objlen:(...e)=>this.chain(new JsonObjLenCommand(e,this.commandOptions)),resp:(...e)=>this.chain(new JsonRespCommand(e,this.commandOptions)),set:(...e)=>this.chain(new JsonSetCommand(e,this.commandOptions)),strappend:(...e)=>this.chain(new JsonStrAppendCommand(e,this.commandOptions)),strlen:(...e)=>this.chain(new JsonStrLenCommand(e,this.commandOptions)),toggle:(...e)=>this.chain(new JsonToggleCommand(e,this.commandOptions)),type:(...e)=>this.chain(new JsonTypeCommand(e,this.commandOptions))}}};function getLengths(e){let t=e.length,n=e.indexOf("=");-1===n&&(n=t);let i=n===t?0:4-n%4;return[n,i]}let i=[],r=[],s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";for(let e=0,t=s.length;e<t;++e)i[e]=s[e],r[s.charCodeAt(e)]=e;let{byteLength:a,toUint8Array:o,fromUint8Array:m}=function(e,t,n=!1){function _byteLength(e,t){return Math.floor((e+t)*3/4-t)}return{byteLength:e=>_byteLength.apply(null,getLengths(e)),toUint8Array(e){let n,i;let[r,s]=getLengths(e),a=new Uint8Array(_byteLength(r,s)),o=s?r-4:r,m=0;for(i=0;i<o;i+=4)n=t[e.charCodeAt(i)]<<18|t[e.charCodeAt(i+1)]<<12|t[e.charCodeAt(i+2)]<<6|t[e.charCodeAt(i+3)],a[m++]=n>>16&255,a[m++]=n>>8&255,a[m++]=255&n;return 2===s?(n=t[e.charCodeAt(i)]<<2|t[e.charCodeAt(i+1)]>>4,a[m++]=255&n):1===s&&(n=t[e.charCodeAt(i)]<<10|t[e.charCodeAt(i+1)]<<4|t[e.charCodeAt(i+2)]>>2,a[m++]=n>>8&255,a[m++]=255&n),a},fromUint8Array(t){let i,r;let s=t.length,a=s%3,o=s-a,m=Array(Math.ceil(o/16383)+(a?1:0)),c=0;for(let n=0;n<o;n+=16383)i=n+16383,m[c++]=function(t,n,i){let r=Array((i-n)/3);for(let a=n,o=0;a<i;a+=3){var s;r[o++]=e[(s=(t[a]<<16)+(t[a+1]<<8)+t[a+2])>>18&63]+e[s>>12&63]+e[s>>6&63]+e[63&s]}return r.join("")}(t,n,i>o?o:i);return 1===a?(r=t[o],m[c]=e[r>>2]+e[r<<4&63],n||(m[c]+="==")):2!==a||(r=t[o]<<8|255&t[o+1],m[c]=e[r>>10]+e[r>>4&63]+e[r<<2&63],n||(m[c]+="=")),m.join("")}}}(i,r,!0),c=new TextDecoder,l=new TextEncoder;function rotl(e,t){return e<<t|e>>>32-t}let SHA1=class SHA1{constructor(){Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"_buf",{enumerable:!0,configurable:!0,writable:!0,value:new Uint8Array(64)}),Object.defineProperty(this,"_bufIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_count",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_K",{enumerable:!0,configurable:!0,writable:!0,value:new Uint32Array([1518500249,1859775393,2400959708,3395469782])}),Object.defineProperty(this,"_H",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_finalized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.init()}static F(e,t,n,i){return e<=19?t&n|~t&i:e<=39?t^n^i:e<=59?t&n|t&i|n&i:t^n^i}init(){return this._H=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),this._bufIdx=0,this._count=new Uint32Array(2),this._buf.fill(0),this._finalized=!1,this}update(e,t){if(null===e)throw TypeError("msg must be a string or Uint8Array.");"string"==typeof e&&(e=function(e,t="utf8"){if(/^utf-?8$/i.test(t))return l.encode(e);if(/^base64$/i.test(t))return o(e);if(/^hex(?:adecimal)?$/i.test(t))return function(e){let t=e.length;if(t%2||!/^[0-9a-fA-F]+$/.test(e))throw TypeError("Invalid hex string.");e=e.toLowerCase();let n=new Uint8Array(Math.floor(t/2)),i=t/2;for(let t=0;t<i;++t)n[t]=parseInt(e.substr(2*t,2),16);return n}(e);throw TypeError("Unsupported string encoding.")}(e,t));for(let t=0;t<e.length;t++)this._buf[this._bufIdx++]=e[t],64===this._bufIdx&&(this.transform(),this._bufIdx=0);let n=this._count;return(n[0]+=e.length<<3)<e.length<<3&&n[1]++,n[1]+=e.length>>>29,this}digest(e){if(this._finalized)throw Error("digest has already been called.");this._finalized=!0;let t=this._buf,n=this._bufIdx;for(t[n++]=128;56!==n;)64===n&&(this.transform(),n=0),t[n++]=0;let i=this._count;t[56]=i[1]>>>24&255,t[57]=i[1]>>>16&255,t[58]=i[1]>>>8&255,t[59]=i[1]>>>0&255,t[60]=i[0]>>>24&255,t[61]=i[0]>>>16&255,t[62]=i[0]>>>8&255,t[63]=i[0]>>>0&255,this.transform();let r=new Uint8Array(20);for(let e=0;e<5;e++)r[(e<<2)+0]=this._H[e]>>>24&255,r[(e<<2)+1]=this._H[e]>>>16&255,r[(e<<2)+2]=this._H[e]>>>8&255,r[(e<<2)+3]=this._H[e]>>>0&255;return this.init(),e?function(e,t="utf8"){if(/^utf-?8$/i.test(t))return c.decode(e);if(/^base64$/i.test(t))return m(e);if(/^hex(?:adecimal)?$/i.test(t))return e.reduce((e,t)=>`${e}${t<16?"0":""}${t.toString(16)}`,"");throw TypeError("Unsupported string encoding.")}(r,e):r}transform(){let e=this._H,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=new Uint32Array(80);for(let e=0;e<16;e++)a[e]=this._buf[(e<<2)+3]|this._buf[(e<<2)+2]<<8|this._buf[(e<<2)+1]<<16|this._buf[e<<2]<<24;for(let e=0;e<80;e++){e>=16&&(a[e]=rotl(a[e-3]^a[e-8]^a[e-14]^a[e-16],1));let o=rotl(t,5)+SHA1.F(e,n,i,r)+s+a[e]+this._K[Math.floor(e/20)]|0;s=r,r=i,i=rotl(n,30),n=t,t=o}e[0]=e[0]+t|0,e[1]=e[1]+n|0,e[2]=e[2]+i|0,e[3]=e[3]+r|0,e[4]=e[4]+s|0}};let Script=class Script{constructor(e,t){Object.defineProperty(this,"script",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sha1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"redis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.redis=e,this.sha1=this.digest(t),this.script=t}async eval(e,t){return await this.redis.eval(this.script,e,t)}async evalsha(e,t){return await this.redis.evalsha(this.sha1,e,t)}async exec(e,t){let n=await this.redis.evalsha(this.sha1,e,t).catch(async n=>{if(n instanceof Error&&n.message.toLowerCase().includes("noscript"))return await this.redis.eval(this.script,e,t);throw n});return n}digest(e){let t=new SHA1().update(e,"utf8").digest("hex");return"string"==typeof t?t:new TextDecoder().decode(t)}};let redis_Redis=class redis_Redis{constructor(e,t){Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"opts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"enableTelemetry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"use",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let t=this.client.request.bind(this.client);this.client.request=n=>e(n,t)}}),Object.defineProperty(this,"addTelemetry",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(this.enableTelemetry)try{this.client.mergeTelemetry(e)}catch{}}}),Object.defineProperty(this,"pipeline",{enumerable:!0,configurable:!0,writable:!0,value:()=>new Pipeline({client:this.client,commandOptions:this.opts,multiExec:!1})}),Object.defineProperty(this,"multi",{enumerable:!0,configurable:!0,writable:!0,value:()=>new Pipeline({client:this.client,commandOptions:this.opts,multiExec:!0})}),Object.defineProperty(this,"append",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new AppendCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"bitcount",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new BitCountCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"bitop",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n,...i)=>new BitOpCommand([e,t,n,...i],this.opts).exec(this.client)}),Object.defineProperty(this,"bitpos",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new BitPosCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"dbsize",{enumerable:!0,configurable:!0,writable:!0,value:()=>new DBSizeCommand(this.opts).exec(this.client)}),Object.defineProperty(this,"decr",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new DecrCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"decrby",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new DecrByCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"del",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new DelCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"echo",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new EchoCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"eval",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new EvalCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"evalsha",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new EvalshaCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"exists",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ExistsCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"expire",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ExpireCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"expireat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ExpireAtCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"flushall",{enumerable:!0,configurable:!0,writable:!0,value:e=>new FlushAllCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"flushdb",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new FlushDBCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"get",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new GetCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"getbit",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new GetBitCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"getdel",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new GetDelCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"getrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new GetRangeCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"getset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new GetSetCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"hdel",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HDelCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hexists",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HExistsCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hget",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HGetCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hgetall",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HGetAllCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hincrby",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HIncrByCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hincrbyfloat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HIncrByFloatCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hkeys",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HKeysCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hlen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HLenCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hmget",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HMGetCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hmset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new HMSetCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"hrandfield",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new HRandFieldCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"hscan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HScanCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new HSetCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"hsetnx",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new HSetNXCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"hstrlen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HStrLenCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"hvals",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new HValsCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"incr",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new IncrCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"incrby",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new IncrByCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"incrbyfloat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new IncrByFloatCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new KeysCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"lindex",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LIndexCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"linsert",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n,i)=>new LInsertCommand([e,t,n,i],this.opts).exec(this.client)}),Object.defineProperty(this,"llen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LLenCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"lmove",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LMoveCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"lpop",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LPopCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"lpos",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LPosCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"lpush",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new LPushCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"lpushx",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new LPushXCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"lrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LRangeCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"lrem",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new LRemCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"lset",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new LSetCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"ltrim",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new LTrimCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"mget",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new MGetCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"mset",{enumerable:!0,configurable:!0,writable:!0,value:e=>new MSetCommand([e],this.opts).exec(this.client)}),Object.defineProperty(this,"msetnx",{enumerable:!0,configurable:!0,writable:!0,value:e=>new MSetNXCommand([e],this.opts).exec(this.client)}),Object.defineProperty(this,"persist",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new PersistCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"pexpire",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new PExpireCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"pexpireat",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new PExpireAtCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"ping",{enumerable:!0,configurable:!0,writable:!0,value:e=>new PingCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"psetex",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new PSetEXCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"pttl",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new PTtlCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"publish",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new PublishCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"randomkey",{enumerable:!0,configurable:!0,writable:!0,value:()=>new RandomKeyCommand().exec(this.client)}),Object.defineProperty(this,"rename",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new RenameCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"renamenx",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new RenameNXCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"rpop",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new RPopCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"rpush",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new RPushCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"rpushx",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new RPushXCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"sadd",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new SAddCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"scan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ScanCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"scard",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SCardCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"scriptExists",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ScriptExistsCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"scriptFlush",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ScriptFlushCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"scriptLoad",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ScriptLoadCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sdiff",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SDiffCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sdiffstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SDiffStoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"set",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new SetCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"setbit",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SetBitCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"setex",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new SetExCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"setnx",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new SetNxCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"setrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SetRangeCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sinter",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SInterCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sinterstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SInterStoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sismember",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new SIsMemberCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"smismember",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new SMIsMemberCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"smembers",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SMembersCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"smove",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new SMoveCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"spop",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SPopCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"srandmember",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SRandMemberCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"srem",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new SRemCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"sscan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SScanCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"strlen",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new StrLenCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sunion",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SUnionCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"sunionstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new SUnionStoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:()=>new TimeCommand().exec(this.client)}),Object.defineProperty(this,"touch",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new TouchCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"ttl",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new TtlCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new TypeCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"unlink",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new UnlinkCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zadd",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>(e[1],new ZAddCommand([e[0],e[1],...e.slice(2)],this.opts).exec(this.client))}),Object.defineProperty(this,"zcard",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZCardCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zcount",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZCountCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zdiffstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZDiffStoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zincrby",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n)=>new ZIncrByCommand([e,t,n],this.opts).exec(this.client)}),Object.defineProperty(this,"zinterstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZInterStoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zlexcount",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZLexCountCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zmscore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZMScoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zpopmax",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZPopMaxCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zpopmin",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZPopMinCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zrange",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZRangeCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zrank",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new ZRankCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"zrem",{enumerable:!0,configurable:!0,writable:!0,value:(e,...t)=>new ZRemCommand([e,...t],this.opts).exec(this.client)}),Object.defineProperty(this,"zremrangebylex",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZRemRangeByLexCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zremrangebyrank",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZRemRangeByRankCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zremrangebyscore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZRemRangeByScoreCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zrevrank",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new ZRevRankCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"zscan",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZScanCommand(e,this.opts).exec(this.client)}),Object.defineProperty(this,"zscore",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>new ZScoreCommand([e,t],this.opts).exec(this.client)}),Object.defineProperty(this,"zunionstore",{enumerable:!0,configurable:!0,writable:!0,value:(...e)=>new ZUnionStoreCommand(e,this.opts).exec(this.client)}),this.client=e,this.opts=t,this.enableTelemetry=t?.enableTelemetry??!0}get json(){return{arrappend:(...e)=>new JsonArrAppendCommand(e,this.opts).exec(this.client),arrindex:(...e)=>new JsonArrIndexCommand(e,this.opts).exec(this.client),arrinsert:(...e)=>new JsonArrInsertCommand(e,this.opts).exec(this.client),arrlen:(...e)=>new JsonArrLenCommand(e,this.opts).exec(this.client),arrpop:(...e)=>new JsonArrPopCommand(e,this.opts).exec(this.client),arrtrim:(...e)=>new JsonArrTrimCommand(e,this.opts).exec(this.client),clear:(...e)=>new JsonClearCommand(e,this.opts).exec(this.client),del:(...e)=>new JsonDelCommand(e,this.opts).exec(this.client),forget:(...e)=>new JsonForgetCommand(e,this.opts).exec(this.client),get:(...e)=>new JsonGetCommand(e,this.opts).exec(this.client),mget:(...e)=>new JsonMGetCommand(e,this.opts).exec(this.client),numincrby:(...e)=>new JsonNumIncrByCommand(e,this.opts).exec(this.client),nummultby:(...e)=>new JsonNumMultByCommand(e,this.opts).exec(this.client),objkeys:(...e)=>new JsonObjKeysCommand(e,this.opts).exec(this.client),objlen:(...e)=>new JsonObjLenCommand(e,this.opts).exec(this.client),resp:(...e)=>new JsonRespCommand(e,this.opts).exec(this.client),set:(...e)=>new JsonSetCommand(e,this.opts).exec(this.client),strappend:(...e)=>new JsonStrAppendCommand(e,this.opts).exec(this.client),strlen:(...e)=>new JsonStrLenCommand(e,this.opts).exec(this.client),toggle:(...e)=>new JsonToggleCommand(e,this.opts).exec(this.client),type:(...e)=>new JsonTypeCommand(e,this.opts).exec(this.client)}}createScript(e){return new Script(this,e)}};let HttpClient=class HttpClient{constructor(e){Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.options={backend:e.options?.backend,agent:e.agent,responseEncoding:e.responseEncoding??"base64",cache:e.cache},this.baseUrl=e.baseUrl.replace(/\/$/,""),this.headers={"Content-Type":"application/json",...e.headers},"base64"===this.options.responseEncoding&&(this.headers["Upstash-Encoding"]="base64"),"boolean"==typeof e?.retry&&e?.retry===!1?this.retry={attempts:1,backoff:()=>0}:this.retry={attempts:e?.retry?.retries??5,backoff:e?.retry?.backoff??(e=>50*Math.exp(e))}}mergeTelemetry(e){function merge(e,t,n){return n&&(e[t]?e[t]=[e[t],n].join(","):e[t]=n),e}this.headers=merge(this.headers,"Upstash-Telemetry-Runtime",e.runtime),this.headers=merge(this.headers,"Upstash-Telemetry-Platform",e.platform),this.headers=merge(this.headers,"Upstash-Telemetry-Sdk",e.sdk)}async request(e){let t={cache:this.options.cache,method:"POST",headers:this.headers,body:JSON.stringify(e.body),keepalive:!0,agent:this.options?.agent,backend:this.options?.backend},n=null,i=null;for(let r=0;r<=this.retry.attempts;r++)try{n=await fetch([this.baseUrl,...e.path??[]].join("/"),t);break}catch(e){i=e,await new Promise(e=>setTimeout(e,this.retry.backoff(r)))}if(!n)throw i??Error("Exhausted all retries");let r=await n.json();if(!n.ok)throw new UpstashError(r.error);return this.options?.responseEncoding==="base64"?Array.isArray(r)?r.map(http_decode):http_decode(r):r}};function base64decode(e){let t="";try{let n=atob(e),i=n.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=n.charCodeAt(e);t=new TextDecoder().decode(r)}catch{t=e}return t}function http_decode(e){let t;switch(typeof e.result){case"undefined":return e;case"number":t=e.result;break;case"object":t=Array.isArray(e.result)?e.result.map(e=>"string"==typeof e?base64decode(e):Array.isArray(e)?e.map(base64decode):e):null;break;case"string":t="OK"===e.result?"OK":base64decode(e.result)}return{result:t,error:e.error}}"undefined"==typeof atob&&(global.atob=function(e){return Buffer.from(e,"base64").toString("utf-8")});let Redis=class Redis extends redis_Redis{constructor(e){if("request"in e){super(e);return}(e.url.startsWith(" ")||e.url.endsWith(" ")||/\r|\n/.test(e.url))&&console.warn("The redis url contains whitespace or newline, which can cause errors!"),(e.token.startsWith(" ")||e.token.endsWith(" ")||/\r|\n/.test(e.token))&&console.warn("The redis token contains whitespace or newline, which can cause errors!");let t=new HttpClient({baseUrl:e.url,retry:e.retry,headers:{authorization:`Bearer ${e.token}`},agent:e.agent,responseEncoding:e.responseEncoding,cache:e.cache||"no-store"});super(t,{automaticDeserialization:e.automaticDeserialization,enableTelemetry:!process.env.UPSTASH_DISABLE_TELEMETRY}),this.addTelemetry({runtime:"string"==typeof EdgeRuntime?"edge-light":`node@${process.version}`,platform:process.env.VERCEL?"vercel":process.env.AWS_REGION?"aws":"unknown",sdk:"@upstash/redis@v1.22.1"})}static fromEnv(e){if(void 0===process?.env)throw Error('Unable to get environment variables, `process.env` is undefined. If you are deploying to cloudflare, please import from "@upstash/redis/cloudflare" instead');let t=process?.env.UPSTASH_REDIS_REST_URL;if(!t)throw Error("Unable to find environment variable: `UPSTASH_REDIS_REST_URL`");let n=process?.env.UPSTASH_REDIS_REST_TOKEN;if(!n)throw Error("Unable to find environment variable: `UPSTASH_REDIS_REST_TOKEN`");return new Redis({...e,url:t,token:n})}}}};