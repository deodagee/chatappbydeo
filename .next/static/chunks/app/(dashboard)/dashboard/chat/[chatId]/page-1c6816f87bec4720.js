(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[635],{8924:function(){},5024:function(){},2918:function(e,t,n){Promise.resolve().then(n.t.bind(n,6964,23)),Promise.resolve().then(n.t.bind(n,3388,23)),Promise.resolve().then(n.bind(n,7449)),Promise.resolve().then(n.bind(n,4958))},7449:function(e,t,n){"use strict";n.r(t);var s=n(7437),r=n(9222),a=n(2265),i=n(5925),l=n(5983),c=n(9977);t.default=e=>{let{chatPartner:t,chatId:n}=e,o=(0,a.useRef)(null),[d,u]=(0,a.useState)(!1),[f,m]=(0,a.useState)(""),sendMessage=async()=>{if(f){u(!0);try{var e;await r.default.post("/api/message/send",{text:f,chatId:n}),m(""),null===(e=o.current)||void 0===e||e.focus()}catch(e){i.Am.error("Something went wrong. Please try again later.")}finally{u(!1)}}};return(0,s.jsx)("div",{className:"border-t border-gray-200 px-4 pt-4 mb-2 sm:mb-0",children:(0,s.jsxs)("div",{className:"relative flex-1 overflow-hidden rounded-lg shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-indigo-600",children:[(0,s.jsx)(l.Z,{ref:o,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),sendMessage())},rows:1,value:f,onChange:e=>m(e.target.value),placeholder:"Message ".concat(t.name),className:"block w-full resize-none border-0 bg-transparent text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:py-1.5 sm:text-sm sm:leading-6"}),(0,s.jsx)("div",{onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()},className:"py-2","aria-hidden":"true",children:(0,s.jsx)("div",{className:"py-px",children:(0,s.jsx)("div",{className:"h-9"})})}),(0,s.jsx)("div",{className:"absolute right-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:(0,s.jsx)("div",{className:"flex-shrin-0",children:(0,s.jsx)(c.Z,{isLoading:d,onClick:sendMessage,type:"submit",children:"Post"})})})]})})}},4958:function(e,t,n){"use strict";n.r(t);var s=n(7437),r=n(9665),a=n(992),i=n(4301),l=n(6691),c=n.n(l),o=n(2265);t.default=e=>{let{initialMessages:t,sessionId:n,chatId:l,chatPartner:d,sessionImg:u}=e,[f,m]=(0,o.useState)(t);(0,o.useEffect)(()=>{r.b.subscribe((0,a.h)("chat:".concat(l)));let messageHandler=e=>{m(t=>[e,...t])};return r.b.bind("incoming-message",messageHandler),()=>{r.b.unsubscribe((0,a.h)("chat:".concat(l))),r.b.unbind("incoming-message",messageHandler)}},[l]);let h=(0,o.useRef)(null),formatTimestamp=e=>(0,i.Z)(e,"HH:mm");return(0,s.jsxs)("div",{id:"messages",className:"flex h-full flex-1 flex-col-reverse gap-4 p-3 overflow-y-auto scrollbar-thumb-blue scrollbar-thumb-rounded scrollbar-track-blue-lighter scrollbar-w-2 scrolling-touch",children:[(0,s.jsx)("div",{ref:h}),f.map((e,t)=>{var r;let i=e.senderId===n,l=(null===(r=f[t-1])||void 0===r?void 0:r.senderId)===f[t].senderId;return(0,s.jsx)("div",{className:"chat-message",children:(0,s.jsxs)("div",{className:(0,a.cn)("flex items-end",{"justify-end":i}),children:[(0,s.jsx)("div",{className:(0,a.cn)("flex flex-col space-y-2 text-base max-w-xs mx-2",{"order-1 items-end":i,"order-2 items-start":!i}),children:(0,s.jsxs)("span",{className:(0,a.cn)("px-4 py-2 rounded-lg inline-block",{"bg-indigo-600 text-white":i,"bg-gray-200 text-gray-900":!i,"rounded-br-none":!l&&i,"rounded-bl-none":!l&&!i}),children:[e.text," ",(0,s.jsx)("span",{className:"ml-2 text-xs text-gray-400",children:formatTimestamp(e.timestamp)})]})}),(0,s.jsx)("div",{className:(0,a.cn)("relative w-6 h-6 p-5",{"order-2":i,"order-1":!i,invisible:l}),children:(0,s.jsx)(c(),{fill:!0,src:i?u:d.image,alt:"Profile picture",referrerPolicy:"no-referrer",className:"rounded-full"})})]})},"".concat(e.id,"-").concat(e.timestamp))})]})}},9977:function(e,t,n){"use strict";n.d(t,{d:function(){return l}});var s=n(7437),r=n(992),a=n(7404),i=n(6264);let l=(0,a.j)("active:scale-95 inline-flex items-center justify-center rounded-md text-sm font-medium transition-color focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{variants:{variant:{default:"bg-slate-900 text-white hover:bg-slate-800",ghost:"bg-transparent hover:text-slate-900 hover:bg-slate-200"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-2",lg:"h-11 px-8"}},defaultVariants:{variant:"default",size:"default"}});t.Z=e=>{let{className:t,children:n,variant:a,isLoading:c,size:o,...d}=e;return(0,s.jsxs)("button",{className:(0,r.cn)(l({variant:a,size:o,className:t})),disabled:c,...d,children:[c?(0,s.jsx)(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,n]})}},9665:function(e,t,n){"use strict";n.d(t,{b:function(){return c}});var s=n(9331),r=n.n(s),a=n(7965),i=n.n(a),l=n(2601);new(r())({appId:l.env.PUSHER_APP_ID,key:"93f5d985ede86198e0c7",secret:l.env.PUSHER_APP_SECRET,cluster:"mt1",useTLS:!0});let c=new(i())("93f5d985ede86198e0c7",{cluster:"mt1"})},992:function(e,t,n){"use strict";n.d(t,{M:function(){return chatHrefConstructor},cn:function(){return cn},h:function(){return toPusherKey}});var s=n(348),r=n(3986);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m)((0,s.W)(t))}function toPusherKey(e){return e.replace(/:/g,"__")}function chatHrefConstructor(e,t){let n=[e,t].sort();return"".concat(n[0],"--").concat(n[1])}}},function(e){e.O(0,[218,135,133,964,620,222,33,971,864,744],function(){return e(e.s=2918)}),_N_E=e.O()}]);